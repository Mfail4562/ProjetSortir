{% extends 'base.html.twig' %}

{% block title %}New Travel{% endblock %}

{% block body %}
    <h1 class="text-center">Create new Travel</h1>
    <div class="card-body px-4 py-5 px-md-5">
        <div class="row">
            <div class="mx-auto col-10 col-md-8 col-lg-6">
                {{ form_start(form) }}
                {{ form_widget(form) }}
                <button class="btn btn-secondary">{{ button_label|default('Save') }}</button>
                <a class="btn btn-secondary m-2 my-sm-0 text-muted mb-1" href="{{ path('app_travel_index') }}">back to
                    Travel list</a>
                {{ form_end(form) }}
            </div>
        </div>
    </div>
{% endblock %}
{% block extraJavascripts %}
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <script>

        $('#AppEntity_Place_city').change(function () {
            let citySelector = $(this);
            $.ajax({
                url: '{{ url('app_travel_listplacesbycity') }}',
                type: 'GET',
                dataType: 'JSON',
                data: {
                    city: citySelector.val()
                },
                success: function (places) {
                    let placesSelect = $('#AppEntity_Place_place');
                    placesSelect.html('');
                    placesSelect.append('<option value> Select a place of City</option>');
                    $.each(places, function (key, place) {
                        placesSelect.append('<option value="' + place.id + '">' + place.name + '</option>')
                    });
                },
                error: function (err) {
                    alert("ya une erreur du con");
                }
            });
        });
    </script>
{% endblock %}
